<!-- معاينة الشهادات - بدون صور طلاب -->
<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
      <!-- Header -->
      <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">معاينة الشهادات</h1>
        <p class="text-lg text-gray-600">راجع جميع الشهادات قبل التصدير</p>
      </div>
  
      <!-- Progress Bar -->
      <div class="w-full bg-gray-200 rounded-full h-2 mb-8">
        <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 80%"></div>
      </div>
  
      <!-- Summary Info -->
      <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="text-center">
            <div class="text-3xl font-bold text-blue-600">{{ certificates.length }}</div>
            <div class="text-sm text-gray-600">إجمالي الشهادات</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-green-600">{{ selectedTemplate?.name || 'غير محدد' }}</div>
            <div class="text-sm text-gray-600">القالب المستخدم</div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-purple-600">{{ getEstimatedSize() }}</div>
            <div class="text-sm text-gray-600">الحجم المتوقع</div>
          </div>
        </div>
      </div>
  
      <!-- Certificate Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <div *ngFor="let certificate of certificates" class="bg-white rounded-lg shadow-md overflow-hidden">
          <!-- Certificate Preview -->
          <div class="relative h-48 bg-gray-100">
            <img [src]="certificate.template.imagePath" class="w-full h-full object-cover">
            
            <!-- Text overlays -->
            <div *ngFor="let textArea of certificate.textAreas" class="absolute text-center"
                 [style.left.%]="(textArea.x - textArea.width/2) / certificate.template.width * 100"
                 [style.top.%]="(textArea.y - textArea.height/2) / certificate.template.height * 100"
                 [style.width.%]="textArea.width / certificate.template.width * 100"
                 [style.height.%]="textArea.height / certificate.template.height * 100"
                 [style.font-size.px]="textArea.fontSize * 0.3"
                 [style.color]="textArea.color">
              
              <!-- الشعار فقط -->
              <div *ngIf="textArea.id === 'logo' && institutionLogo" class="w-full h-full flex items-center justify-center">
                <img [src]="institutionLogo" class="max-w-full max-h-full object-contain">
              </div>
              
              <!-- النصوص العادية -->
              <div *ngIf="textArea.id !== 'logo'" class="w-full h-full flex items-center justify-center">
                {{ getDisplayText(certificate, textArea) }}
              </div>
            </div>
          </div>
  
          <!-- Certificate Info -->
          <div class="p-4">
            <h3 class="font-semibold text-gray-800">{{ certificate.student.name }}</h3>
            <p class="text-sm text-gray-600">{{ certificate.template.name }}</p>
          </div>
        </div>
      </div>
  
      <!-- Export Panel -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-4">تصدير الشهادات</h2>
        
        <!-- Export Settings -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <!-- Format Selection -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-3">تنسيق الملف</label>
            <div class="space-y-2">
              <div *ngFor="let format of availableFormats" 
                   class="flex items-center p-3 border rounded-lg cursor-pointer"
                   [class.border-blue-500]="exportSettings.format === format.value"
                   [class.bg-blue-50]="exportSettings.format === format.value"
                   (click)="setFormat(format.value)">
                <input type="radio" [value]="format.value" [(ngModel)]="exportSettings.format" class="mr-3">
                <div>
                  <div class="font-medium">{{ format.name }}</div>
                  <div class="text-sm text-gray-600">{{ format.description }}</div>
                </div>
              </div>
            </div>
          </div>
  
          <!-- Quality Selection -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-3">جودة التصدير</label>
            <div class="space-y-2">
              <div *ngFor="let quality of availableQualities" 
                   class="flex items-center p-3 border rounded-lg cursor-pointer"
                   [class.border-blue-500]="exportSettings.quality === quality.value"
                   [class.bg-blue-50]="exportSettings.quality === quality.value"
                   (click)="setQuality(quality.value)">
                <input type="radio" [value]="quality.value" [(ngModel)]="exportSettings.quality" class="mr-3">
                <div>
                  <div class="font-medium">{{ quality.name }}</div>
                  <div class="text-sm text-gray-600">مقياس: {{ quality.scale }}x</div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <!-- Export Actions -->
        <div class="flex gap-4">
          <button (click)="exportAll()" 
                  [disabled]="isExporting"
                  class="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400">
            تصدير جميع الشهادات
          </button>
          
          <button (click)="exportSelected()" 
                  [disabled]="isExporting || selectedCertificates.size === 0"
                  class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400">
            تصدير المحدد ({{ selectedCertificates.size }})
          </button>
        </div>
  
        <!-- Progress -->
        <div *ngIf="isExporting" class="mt-4">
          <div class="w-full bg-gray-200 rounded-full h-4 mb-2">
            <div class="bg-blue-600 h-4 rounded-full transition-all" [style.width.%]="exportProgress"></div>
          </div>
          <p class="text-sm text-gray-600 text-center">{{ exportStatus }} - {{ exportProgress }}%</p>
        </div>
      </div>
  
      <!-- Navigation -->
      <div class="flex justify-between items-center mt-8">
        <button (click)="goBack()" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400">
          السابق
        </button>
        
        <button (click)="startOver()" class="px-6 py-3 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600">
          بدء جديد
        </button>
      </div>
    </div>
  </div>